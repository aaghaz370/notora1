<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Aaghaz — Book Flip Animation</title>
<style>
  :root{
    --book-width: 760px;
    --book-height: 520px;
    --page-count-desktop: 10;
    --page-count-mobile: 6;
    --speed-desktop: 1.4s; /* one page flip duration */
    --speed-mobile: 1.8s;
    --bg1: #0f172a;
    --bg2: #071334;
    --cover-color: #b84b3a;
    --paper: #fffdf7;
    --paper-edge: #e6e1d8;
  }

  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Arial;color:#e6edf3;background:linear-gradient(180deg,var(--bg1),var(--bg2));-webkit-font-smoothing:antialiased;display:flex;align-items:center;justify-content:center;padding:24px;box-sizing:border-box}

  .stage{
    width:100%;
    max-width:calc(var(--book-width) + 40px);
    display:flex;
    gap:20px;
    align-items:center;
    justify-content:center;
    flex-direction:column;
  }

  .book-wrap{
    perspective:1600px;
    width:100%;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .book{
    width:var(--book-width);
    height:var(--book-height);
    position:relative;
    transform-style:preserve-3d;
    transition:transform .9s ease;
    will-change:transform;
  }

  /* Cover */
  .cover{
    position:absolute;
    inset:0;
    transform-origin:left center;
    background:linear-gradient(180deg,rgba(255,255,255,0.06), rgba(0,0,0,0.06));
    box-shadow:0 12px 40px rgba(2,6,23,0.7), inset 0 3px 0 rgba(255,255,255,0.02);
    z-index:60;
    display:flex;
    align-items:center;
    justify-content:center;
    color:white;
    font-weight:700;
    font-size:22px;
    user-select:none;
  }

  .cover.front{
    left:0;
    width:50%;
    background:linear-gradient(135deg,var(--cover-color),#9c3c2f);
    transform-origin:left center;
    transform:translateZ(40px);
    border-top-left-radius:6px;
    border-bottom-left-radius:6px;
  }

  .cover.back{
    right:0;
    width:50%;
    transform-origin:right center;
    transform:translateZ(20px);
    background:linear-gradient(135deg,#7f2f26,#6a2520);
    border-top-right-radius:6px;
    border-bottom-right-radius:6px;
    z-index:10;
  }

  .spine{
    position:absolute;
    left:calc(50% - 10px);
    width:20px;
    height:100%;
    background:linear-gradient(180deg,#6b2d25,#4e1f1a);
    transform:translateZ(50px);
    z-index:70;
    border-radius:3px;
  }

  /* Pages container */
  .pages{
    position:absolute;
    inset:0;
    left:0;
    right:0;
    display:block;
    transform-style:preserve-3d;
    pointer-events:none;
  }

  .page{
    position:absolute;
    width:50%;
    height:96%;
    left:50%;
    top:2%;
    transform-origin:left center;
    transform-style:preserve-3d;
    backface-visibility:hidden;
    box-shadow: 0 6px 22px rgba(2,6,23,0.45);
    overflow:hidden;
    border-radius:2px;
    z-index:30;
  }

  /* content of a page (front and back) */
  .page .side{
    position:absolute;
    inset:0;
    background:linear-gradient(180deg,var(--paper), #fbf8f0);
    border-left:1px solid rgba(0,0,0,0.06);
    box-shadow: inset -12px 0 30px rgba(0,0,0,0.02);
    backface-visibility:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
    color:#1b1b1b;
    padding:28px;
    box-sizing:border-box;
  }

  .page .back{
    transform:rotateY(180deg);
    background:linear-gradient(180deg,#fffdf7,#f7f3ea);
  }

  /* thin page edges visible */
  .page::after{
    content:'';
    position:absolute;
    right:-8px;
    top:0;
    width:8px;
    height:100%;
    background:linear-gradient(90deg, rgba(0,0,0,0.03), rgba(0,0,0,0));
    pointer-events:none;
  }

  /* flip animation */
  @keyframes flip {
    0% { transform: rotateY(0deg); z-index:30; }
    49.9% { transform: rotateY(-170deg); z-index:500; }
    50% { transform: rotateY(-180deg); z-index:10; }
    100% { transform: rotateY(-180deg); z-index:10; }
  }

  /* open cover animation */
  .book.open .cover.front { transform: rotateY(-155deg) translateZ(20px); box-shadow:none; }
  .book.open .cover.back  { transform: rotateY(20deg) translateZ(10px); }
  .book.closed .cover.front { transform: rotateY(0deg) }
  .book.closed .cover.back  { transform: rotateY(0deg) }

  /* Stagger pages' animation using nth-child */
  /* default uses CSS variables set by JS; fallback for 10 pages */
  .pages .page:nth-child(1){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 0); }
  .pages .page:nth-child(2){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 0.3); }
  .pages .page:nth-child(3){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 0.6); }
  .pages .page:nth-child(4){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 0.9); }
  .pages .page:nth-child(5){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 1.2); }
  .pages .page:nth-child(6){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 1.5); }
  .pages .page:nth-child(7){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 1.8); }
  .pages .page:nth-child(8){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 2.1); }
  .pages .page:nth-child(9){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 2.4); }
  .pages .page:nth-child(10){ animation: flip var(--dur) linear infinite; animation-delay: calc(var(--dur) * 2.7); }

  /* overlay title */
  .label{ color:#dbeafe;font-weight:600;margin-bottom:10px; text-align:center; }

  .controls{ display:flex;gap:10px; align-items:center; margin-top:12px; color:#c7d2fe; }
  .controls button, .controls input[type="range"]{ background:transparent;border:1px solid rgba(255,255,255,0.08); color:inherit; padding:8px 10px; border-radius:8px }
  .controls button:hover{ border-color:rgba(255,255,255,0.14); cursor:pointer }

  /* responsiveness */
  @media (max-width:900px){
    :root{ --book-width:520px; --book-height:360px }
  }
  @media (max-width:520px){
    :root{ --book-width:320px; --book-height:420px }
    .label{ font-size:14px }
    .controls{ flex-direction:column; align-items:stretch }
  }

  /* reduced motion */
  @media (prefers-reduced-motion: reduce){
    .pages .page{ animation: none !important; transform:rotateY(-180deg) }
  }

  /* small captions inside pages to resemble content */
  .page p{ margin:0; text-align:left; line-height:1.45; color:#2b2b2b; font-size:14px; max-width:90% }
  .page .number{ position:absolute; bottom:10px; right:12px; font-size:12px; color:#7a7a7a }
</style>
</head>
<body>
  <div class="stage">
    <div class="label">Aaghaz — Continuous Page Flip</div>

    <div class="book-wrap">
      <div id="book" class="book closed" aria-hidden="false" role="application">
        <div class="cover back">Back Cover</div>
        <div class="spine" aria-hidden="true"></div>
        <div class="pages" id="pages"></div>
        <div class="cover front">AAGHAZ</div>
      </div>
    </div>

    <div class="controls" aria-hidden="false">
      <button id="toggleOpen">Open / Close</button>
      <button id="pauseBtn">Pause</button>
      <label style="display:flex;align-items:center;gap:8px">
        Speed
        <input id="speed" type="range" min="0.5" max="2.5" step="0.1" value="1">
      </label>
    </div>
  </div>

<script>
(function(){
  const book = document.getElementById('book');
  const pagesEl = document.getElementById('pages');
  const toggleOpen = document.getElementById('toggleOpen');
  const pauseBtn = document.getElementById('pauseBtn');
  const speedInput = document.getElementById('speed');

  // responsive defaults
  const isMobile = window.matchMedia('(max-width:520px)').matches;
  const pageCount = isMobile ? parseInt(getComputedStyle(document.documentElement).getPropertyValue('--page-count-mobile')) || 6
                             : parseInt(getComputedStyle(document.documentElement).getPropertyValue('--page-count-desktop')) || 10;

  // set CSS duration variable based on screen
  const defaultDur = isMobile ? getComputedStyle(document.documentElement).getPropertyValue('--speed-mobile').trim() : getComputedStyle(document.documentElement).getPropertyValue('--speed-desktop').trim();
  document.documentElement.style.setProperty('--dur', defaultDur);

  // create pages dynamically: each page has .side(front) and .side back
  function makePage(index, total){
    const el = document.createElement('div');
    el.className = 'page';
    el.style.zIndex = Math.max(1, total - index); // stacking
    // small content front
    const front = document.createElement('div');
    front.className = 'side front';
    front.innerHTML = `<p>Chapter ${Math.ceil(index/2)+1}: Sample content preview. This shows flowing text to mimic a page.</p><div class="number">${index}</div>`;
    // back side
    const back = document.createElement('div');
    back.className = 'side back';
    back.innerHTML = `<p>Continuation — more sample content for page ${index}. Smooth continuous flip.</p><div class="number">${index}</div>`;
    el.appendChild(front);
    el.appendChild(back);
    return el;
  }

  // build sequence of pages
  pagesEl.innerHTML = '';
  for (let i=0;i<pageCount;i++){
    pagesEl.appendChild(makePage(i+1,pageCount));
  }

  // stagger animation delays programmatically for browsers that may not support many nth-child
  const pages = Array.from(pagesEl.children);
  const durSeconds = parseFloat(defaultDur);
  pages.forEach((pg, i) => {
    const stagger = i * (durSeconds * 0.35);
    pg.style.animation = `flip calc(var(--dur)) linear infinite`;
    pg.style.animationDelay = stagger + 's';
  });

  // controls
  let paused = false;
  pauseBtn.addEventListener('click', ()=>{
    paused = !paused;
    pages.forEach(pg => pg.style.animationPlayState = paused ? 'paused' : 'running');
    pauseBtn.textContent = paused ? 'Resume' : 'Pause';
  });

  toggleOpen.addEventListener('click', ()=>{
    book.classList.toggle('open');
    book.classList.toggle('closed');
  });

  speedInput.addEventListener('input', (e)=>{
    // adjust base duration variable
    const mult = parseFloat(e.target.value); // 0.5-2.5 range
    const base = isMobile ? parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--speed-mobile')) || 1.8
                          : parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--speed-desktop')) || 1.4;
    const newDur = (base / mult).toFixed(2) + 's';
    document.documentElement.style.setProperty('--dur', newDur);
    // reapply per-page stagger using new dur
    const newDurSec = parseFloat(newDur);
    pages.forEach((pg, i) => {
      const stagger = i * (newDurSec * 0.35);
      pg.style.animationDelay = stagger + 's';
    });
  });

  // accessibility: respect reduced motion
  const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  if (reduce){
    pages.forEach(pg => pg.style.animation = 'none');
    pauseBtn.disabled = true;
    speedInput.disabled = true;
  }

  // start with book opened after small delay for visual entrance
  setTimeout(()=> book.classList.add('open'), 300);

  // on resize: if width small and pages > mobile, reduce complexity (not recreating here to keep UX stable)
  window.addEventListener('resize', ()=>{
    // could implement dynamic rebuild if desired
  });

})();
</script>
</body>
</html>